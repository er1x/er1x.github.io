<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Las partes de este tutorial son:Parte 1: el hola mundo de Meteor y la estructura de un proyecto.Parte 2: cómo crear vistas y rutas e introducción a Atmosphere.Parte 3: las colecciones de datos.Parte 4"><meta property="og:type" content="article"><meta property="og:title" content="Megatutorial Meteor en Español (2) - El framework más popular en Github"><meta property="og:url" content="https://github.com/er1x/2016/01/megatutorial-meteor-dos/index.html"><meta property="og:site_name" content="Emilio J. Grande | Web Developer"><meta property="og:description" content="Las partes de este tutorial son:Parte 1: el hola mundo de Meteor y la estructura de un proyecto.Parte 2: cómo crear vistas y rutas e introducción a Atmosphere.Parte 3: las colecciones de datos.Parte 4"><meta property="og:image" content="https://github.com/er1x/images/2015-12/meteor.jpg"><meta property="og:image" content="https://github.com/er1x/images/2016-01/listado.png"><meta property="og:image" content="https://github.com/er1x/images/2016-01/productos-cliente.png"><meta property="og:image" content="https://github.com/er1x/images/2016-01/atmosphere.png"><meta property="og:updated_time" content="2017-03-06T15:41:47.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Megatutorial Meteor en Español (2) - El framework más popular en Github"><meta name="twitter:description" content="Las partes de este tutorial son:Parte 1: el hola mundo de Meteor y la estructura de un proyecto.Parte 2: cómo crear vistas y rutas e introducción a Atmosphere.Parte 3: las colecciones de datos.Parte 4"><meta name="twitter:image" content="https://github.com/er1x/images/2015-12/meteor.jpg"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><title>Megatutorial Meteor en Español (2) - El framework más popular en Github</title><style type="text/css">.content h1,.fa,body{-moz-osx-font-smoothing:grayscale}.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased}.content h1,.content h2{font-weight:700;display:block}body,pre{font-family:Menlo,"Meslo LG",monospace}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-tag:before{content:"\f02b"}.fa-list:before{content:"\f03a"}.fa-chevron-up:before{content:"\f077"}.fa-bars:before{content:"\f0c9"}#header-post #toc .toc-level-2:before,.article-tag .tag-link:before,article .content h2:before{content:"#"}*,:after,:before{box-sizing:border-box}.content h1,body{-webkit-font-smoothing:antialiased}.my4{margin-top:4rem;margin-bottom:4rem}.mx-auto{margin-left:auto;margin-right:auto}.px2{padding-left:1rem;padding-right:1rem}.content h1{letter-spacing:.01em;font-size:1.5em;font-style:normal;color:#2bbc8a;margin-top:3rem;margin-bottom:1rem}.content h2{position:relative;font-size:1rem;text-transform:none;letter-spacing:normal;margin-top:2rem;margin-bottom:.5rem;color:#eee}#header-post #nav ul li{border-right:1px dotted #2bbc8a}.content em{font-style:italic}.content ul,body{line-height:1.725}.content td{border-bottom:none;padding:9px 8px 0}html{height:100%;border-top:2px solid #c9cacc}body{text-rendering:geometricPrecision;color:#c9cacc;background-color:#1d1f21;font-size:14px;font-weight:400;min-height:100%;display:flex;flex-direction:column}.content{flex:1}.content p{-moz-hyphens:auto;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.content pre{-moz-hyphens:manual;-ms-hyphens:manual;-webkit-hyphens:manual;hyphens:manual}.content a{text-decoration:none;color:#c9cacc;background-repeat:repeat-x;background-position:bottom;background-size:100% 6px;background-image:linear-gradient(transparent,transparent 5px,#c9cacc 5px,#c9cacc)}#header-post a,.content h2 a{color:inherit;background:0 0;text-decoration:none}#header-post #nav ul li:last-child a,#header-post ul li:last-child{margin-right:0}.width{width:100%;max-width:39rem}@media (max-width:480px){.my4{margin-top:2rem;margin-bottom:2rem}}#header-post #nav ul{line-height:15px}#header-post #nav{font-style:normal;font-weight:200;letter-spacing:.01em;font-size:.8rem;color:#2bbc8a}#header-post{position:fixed;top:2rem;right:2rem;display:inline-block;float:right}#header-post ol{list-style-type:none}#header-post ul{list-style-type:none;margin:0;padding:0;display:inline-block}#header-post ul li{margin-right:15px;display:inline-block;vertical-align:middle}#header-post #menu-icon,#header-post #menu-icon-tablet{float:right;margin-left:15px}#header-post #top-icon-tablet{margin-left:15px;bottom:2rem;right:2rem;position:fixed}#header-post #menu{visibility:hidden}#header-post #nav ul a{margin-right:15px;color:color-accent}#header-post #nav ul li:last-child{border-right:0;margin-right:0}#header-post #toc{clear:both;text-align:right;padding-top:1rem}#header-post #toc .toc-number{display:none}#header-post #toc .toc-level-2{font-size:.8rem;color:#c9cacc}#header-post #toc .toc-level-2:before{color:#2bbc8a}#header-post #toc .toc-level-3{font-size:.7rem;color:#b3b3b3}#header-post #toc .toc-level-4{font-size:.4rem;color:#666}@media screen and (max-width:500px){#header-post{display:none}}@media screen and (max-width:900px){#header-post #menu-icon{display:none}}@media screen and (max-width:1199px){#header-post #toc{display:none}}@media screen and (min-width:900px){#header-post #menu-icon-tablet,#header-post #top-icon-tablet{display:none!important}}#footer-post{bottom:0;left:0;right:0;position:fixed;width:100%;z-index:5000000;background:#212326;border-top:1px solid #666673}#footer-post a,#footer-post a.icon,.highlight pre{background:0 0}#footer-post a{color:inherit;text-decoration:none}#footer-post #nav-footer{margin-left:1rem;margin-right:1rem;text-align:center}#footer-post #nav-footer a{color:#2bbc8a;font-size:1rem}#footer-post #actions-footer ul,#footer-post #nav-footer ul{list-style-type:none;margin:0;padding:0;display:table;width:100%}#footer-post #nav-footer ul li{display:inline-table;width:20%;padding:10px;vertical-align:middle}#footer-post #actions-footer{text-align:center;margin-top:1rem;margin-bottom:1rem;width:100%}#footer-post #actions-footer a{color:#2bbc8a}#footer-post #actions-footer ul li{display:table-cell;vertical-align:middle}#footer-post #toc-footer .toc-level-4,#footer-post #toc-footer .toc-number{display:none}#footer-post #toc-footer{clear:both;text-align:left;padding-top:1rem}#footer-post #toc-footer ol{list-style-type:none;padding-left:20px}#footer-post #toc-footer ol li{line-height:30px}#footer-post #toc-footer .toc-level-2{font-size:.8rem;color:#c9cacc}#footer-post #toc-footer .toc-level-2:before{content:"#";color:#2bbc8a}#footer-post #toc-footer .toc-level-3{font-size:.7rem;color:#666;line-height:15px}@media screen and (min-width:500px){#footer-post-container{display:none}}article header .posttitle{margin-top:0;margin-bottom:0;text-transform:none;font-size:1.5em;line-height:1.25}article header .meta{margin-top:0;margin-bottom:1rem}article header .meta *{color:#ccc;font-size:.85rem}article header .author{text-transform:uppercase;letter-spacing:.01em;font-weight:700}article header .postdate{display:inline}article .content h2:before{color:#2bbc8a;position:absolute;left:-1rem;top:-4px;font-size:1.2rem;font-weight:700}article .content img{max-width:100%;height:auto;display:block;margin:auto}.posttitle{text-transform:none;font-size:1.5em;line-height:1.25}@media (min-width:480px){p{text-align:justify}.article-tag{display:inline}.article-tag:before{content:"|"}}pre{overflow-x:auto;font-size:13px;padding:10px 15px 0;line-height:22px;-webkit-border-radius:4px;border-radius:4px;border:1px dotted #666}.highlight pre{padding:0;border:none}.highlight td.gutter{text-align:right;padding-right:20px;display:none}</style></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></span><br><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Go-Spacebars-El-motor-de-plantillas-de-Meteor"><span class="toc-number">1.</span> <span class="toc-text">Go Spacebars! El motor de plantillas de Meteor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Creando-vistas"><span class="toc-number">1.1.</span> <span class="toc-text">Creando vistas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#client-templates-layout-html"><span class="toc-number">1.1.1.</span> <span class="toc-text">client/templates/layout.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#client-templates-products-html"><span class="toc-number">1.1.2.</span> <span class="toc-text">client/templates/products.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#client-templates-product-card-html"><span class="toc-number">1.1.3.</span> <span class="toc-text">client/templates/product-card.html</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Una-lista-de-productos-a-lo-burro"><span class="toc-number">2.</span> <span class="toc-text">Una lista de productos: a lo burro</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lib-collections-products-js"><span class="toc-number">2.1.</span> <span class="toc-text">lib/collections/products.js</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AtmosphereJS-paquetes-para-Meteor"><span class="toc-number">3.</span> <span class="toc-text">AtmosphereJS: paquetes para Meteor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Iron-Router"><span class="toc-number">3.1.</span> <span class="toc-text">Iron Router</span></a></li></ol></li></ol></div></span></div><div class="content index width mx-auto px2 my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Megatutorial Meteor en Español (2) - El framework más popular en Github</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Emilio J. Grande | Web Developer</span></span><div class="postdate"><time datetime="2016-01-04T10:55:39.000Z" itemprop="datePublished">04-01-2016</time></div><div class="article-tag"><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/meteor/">meteor</a></div></div></header><div class="content" itemprop="articleBody"><p><img src="/images/2015-12/meteor.jpg" alt="Meteor"></p><p>Las partes de este tutorial son:</p><ul><li><a href="/2015/12/megatutorial-meteor-uno/">Parte 1</a>: el <em>hola mundo</em> de Meteor y la estructura de un proyecto.</li><li><a href="/2016/01/megatutorial-meteor-dos/">Parte 2</a>: cómo crear vistas y rutas e introducción a <a href="http://atmospherejs.com/" target="_blank" rel="external">Atmosphere</a>.</li><li><a href="/2016/01/megatutorial-meteor-tres/">Parte 3</a>: las colecciones de datos.</li><li><a href="/2016/02/megatutorial-meteor-cuatro/">Parte 4</a>: usuarios y autenticación.</li><li><a href="/2016/02/megatutorial-meteor-cinco/">Parte 5</a>: llamadas a métodos en el servidor.</li></ul><p>Si recuerdas <a href="/2015/12/megatutorial-meteor-uno/">el anterior tutorial introductorio</a>, habíamos creado un proyecto en blanco de meteor y creado una estructura básica para un proyecto más o menos decente :P</p><p>En esta entrega de hoy toca decidir las páginas que va a tener nuestra aplicacion, maquetar un poco, añadir algo de CSS y configurar la navegación entre las diferentes páginas.</p><p>Vamos a ello!</p><h2 id="Go-Spacebars-El-motor-de-plantillas-de-Meteor"><a href="#Go-Spacebars-El-motor-de-plantillas-de-Meteor" class="headerlink" title="Go Spacebars! El motor de plantillas de Meteor"></a>Go Spacebars! El motor de plantillas de Meteor</h2><p>Como ya te he contado, <a href="https://github.com/meteor/meteor/tree/devel/packages/spacebars">Spacebars</a> es el motor de plantillas de Meteor. Por tanto vamos a escribir las diferentes vistas de la aplicación con este lenguaje.</p><p>Las vistas que tendremos serán, a saber:</p><ul><li>Un listado con los productos de la tienda.</li><li>Una vista de detalle de producto.</li><li>Una vista con el carrito de la compra.</li><li>Una página <em>Acerca de</em>.</li></ul><p>Estas paǵinas compartirán un header y un footer.</p><p>Let’s go.</p><h3 id="Creando-vistas"><a href="#Creando-vistas" class="headerlink" title="Creando vistas"></a>Creando vistas</h3><h4 id="client-templates-layout-html"><a href="#client-templates-layout-html" class="headerlink" title="client/templates/layout.html"></a>client/templates/layout.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>StarWars Shop!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootswatch/latest/sandstone/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootstrap/latest/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">"layout"</span>&gt;</span></div><div class="line">  &#123;&#123; &gt; navbar &#125;&#125;</div><div class="line"></div><div class="line">  &#123;&#123; &gt; yield &#125;&#125;</div><div class="line"></div><div class="line">  &#123;&#123; &gt; footer &#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p>El layout es la plantilla principal, que incluye 2 plantillas adicionales (la barra de navegación y el footer), así como la directiva especial <em>yield</em>. Esta directiva le dice a Meteor que incruste la plantilla que especifiquemos en el router. No te preocupes, que esto lo vemos más abajo :P</p><p>También hemos incluido Bootstrap, directamente desde un CDN.</p><h4 id="client-templates-products-html"><a href="#client-templates-products-html" class="headerlink" title="client/templates/products.html"></a>client/templates/products.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">"products"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container products"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Productos Disponibles<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">hr</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row category-credit"</span> <span class="attr">style</span>=<span class="string">"margin-top:20px"</span>&gt;</span></div><div class="line">    &#123;&#123;#each products&#125;&#125;</div><div class="line">      &#123;&#123; &gt; productCard&#125;&#125;</div><div class="line">    &#123;&#123;/each&#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p>Esta plantilla <em>products.html</em> iría en lugar del yield. Como ves es una plantilla muy normal, itera con un <em>#each</em> sobre una variable de productos, y por cada uno incrusta una plantilla <em>productCard</em>.</p><h4 id="client-templates-product-card-html"><a href="#client-templates-product-card-html" class="headerlink" title="client/templates/product-card.html"></a>client/templates/product-card.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">"productCard"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-lg-2 col-md-4 col-xs-6 thumb "</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"thumbnail"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">href</span>=<span class="string">"/products/&#123;&#123;id&#125;&#125;"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"img-responsive"</span> <span class="attr">src</span>=<span class="string">"/img/&#123;&#123;image&#125;&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrapper"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"caption post-content"</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrapper"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-meta"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"price"</span>&gt;</span>&#123;&#123;price&#125;&#125; €<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p>La plantilla <em>productCard</em> consiste en un pequeño <em>thumbnail</em> del poster. Utiliza clases de Bootstrap y variables que le vienen de un objeto especificando un id, una imagen, título y precio.</p><p>La cosa queda más o menos así:</p><p><img src="/images/2016-01/listado.png" alt="Listado"></p><p>Básicamente, lo importante que quiero que veas aquí es:</p><ul><li><strong>Cómo se incluyen unas plantillas dentro de otras</strong> (usando {{ > plantilla }})</li><li>Que las <strong>plantillas tienen que tener un nombre</strong>.</li><li>Que <strong>dentro de ellas puedes usar bucles y utilizar variables</strong>.</li></ul><p>Vale pero… ¿Cómo se le pasan estas variables a la plantilla? ¿Cómo se navega entre vistas?</p><p>Pues esto se hace con el <strong>Router</strong>. Pero primero necesitamos los datos de los productos, ¿no?</p><p>Vamos a crearlos.</p><h2 id="Una-lista-de-productos-a-lo-burro"><a href="#Una-lista-de-productos-a-lo-burro" class="headerlink" title="Una lista de productos: a lo burro"></a>Una lista de productos: <em>a lo burro</em></h2><p>Como de momento estamos maquetando y creando la navegación, vamos a pasar de momento de la base de datos y a meter los productos en memoria. ¿Dónde? Pues en la carpeta <em>lib</em>:</p><h3 id="lib-collections-products-js"><a href="#lib-collections-products-js" class="headerlink" title="lib/collections/products.js"></a>lib/collections/products.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Products = [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="string">'1'</span>,</div><div class="line">    <span class="attr">title</span>: <span class="string">'Poster: Star Wars'</span>,</div><div class="line">    <span class="attr">price</span>: <span class="number">12345</span>,</div><div class="line">    <span class="attr">image</span>: <span class="string">'poster1.jpg'</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="string">'2'</span>,</div><div class="line">    <span class="attr">title</span>: <span class="string">'Poster: Yoda'</span>,</div><div class="line">    <span class="attr">price</span>: <span class="number">12345</span>,</div><div class="line">    <span class="attr">image</span>: <span class="string">'poster2.jpg'</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">id</span>: <span class="string">'3'</span>,</div><div class="line">    <span class="attr">title</span>: <span class="string">'Poster: La Venganza de los Sith'</span>,</div><div class="line">    <span class="attr">price</span>: <span class="number">12345</span>,</div><div class="line">    <span class="attr">image</span>: <span class="string">'poster3.jpg'</span></div><div class="line">  &#125;,</div><div class="line">  ...</div><div class="line">];</div></pre></td></tr></table></figure><p>Como ves, es un array mondo y lirondo. Y como está en la carpeta <em>lib</em>, está disponible tanto en el servidor como en el cliente.</p><p>Mira cómo aparece en la consola:</p><p><img src="/images/2016-01/productos-cliente.png" alt="Productos en cliente"></p><p>Para que estos productos estén disponibles en una plantilla, podemos crear <em>helpers</em> asociados. Por ejemplo en el listado de productos principal:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Template.products.helpers(&#123;</div><div class="line">  <span class="attr">products</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> Products;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p>Ahora llega la hora de introducir el router y configurar la navegación.</p><h2 id="AtmosphereJS-paquetes-para-Meteor"><a href="#AtmosphereJS-paquetes-para-Meteor" class="headerlink" title="AtmosphereJS: paquetes para Meteor"></a>AtmosphereJS: paquetes para Meteor</h2><p>El router no viene por defecto con Meteor, tenemos que instalarlo.</p><p>Para ello usaremos <strong>el repositorio de paquetes de Meteor: <a href="https://atmospherejs.com/" target="_blank" rel="external">AtmosphereJS</a></strong>.</p><p><img src="/images/2016-01/atmosphere.png" alt="Atmosphere"></p><p><strong>Para instalar un paquete en Meteor usamos el comando <em>meteor add</em></strong>, en este caso queremos instalar el paquete <strong>Iron-Router</strong>, de modo que:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">meteor add iron:router</div></pre></td></tr></table></figure><p>Tan sencillo como eso. Pero ahora tenemos que configurar este router.</p><h3 id="Iron-Router"><a href="#Iron-Router" class="headerlink" title="Iron Router"></a>Iron Router</h3><p>Tenemos que crear un archivo disponible en cliente y servidor, yo por ejemplo lo meteré en lib/router.js. En él tenemos una variable Router, a la cual deberemos especificarle las rutas de las páginas.</p><p>En este caso vamos a poner:</p><ul><li><strong>/</strong>: para el listado de productos principal.</li><li><strong>/about</strong>: para el acerca-de.</li><li><strong>/products/:id</strong>: para el detalle de un producto.</li></ul><p>Quedaría así:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Router.configure(&#123;</div><div class="line">  <span class="attr">layoutTemplate</span>: <span class="string">'layout'</span>,</div><div class="line">  <span class="attr">notFoundTemplate</span>: <span class="string">'404'</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">Router.route(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.render(<span class="string">'products'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Router.route(<span class="string">'/about'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.render(<span class="string">'about'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Router.route(<span class="string">'/products/:id'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">  <span class="keyword">var</span> product = _.find(Products, <span class="function"><span class="keyword">function</span>(<span class="params">prod</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> (prod.id === that.params.id);</div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">this</span>.render(<span class="string">'productDetail'</span>, &#123;</div><div class="line">    <span class="attr">data</span>: product</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p>Como ves, al router se le pasa una pequeña configuración por defecto, las rutas que queremos y una función de callback que realice el render de la vista apropiada.</p><p>En el caso del detalle de producto, utilizamos <strong><a href="http://underscorejs.org/" target="_blank" rel="external">Underscore</a></strong> para buscar el producto por id y pasarselo a la plantilla como dato. Underscore está por defecto disponible en cualquier lugar de una aplicación web Meteor.</p><hr><p>En este post hemos visto cómo crear plantillas en Meteor y a utilizar un Router para navegar en la aplicación. A mí cuando aprendí me pareció bastante sencillo viniendo de otros frameworks, aunque me extrañó el tener que añadir a mayores el router, pues normalmente viene por defecto.</p><p>Por lo demás Spacebars lo hace fácil. Es sencillo dividir una aplicación en componentes con este uso de las plantillas. Si lo complementas con clases CSS diferenciadas queda una aplicación modular bastante maja.</p><p>¿A ti qué te ha parecido?</p><p>¿Sencillo? ¿Chungo?</p><p>¿Añadirías algo? ¡No dudes en comentar!</p></div></article></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Go-Spacebars-El-motor-de-plantillas-de-Meteor"><span class="toc-number">1.</span> <span class="toc-text">Go Spacebars! El motor de plantillas de Meteor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Creando-vistas"><span class="toc-number">1.1.</span> <span class="toc-text">Creando vistas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#client-templates-layout-html"><span class="toc-number">1.1.1.</span> <span class="toc-text">client/templates/layout.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#client-templates-products-html"><span class="toc-number">1.1.2.</span> <span class="toc-text">client/templates/products.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#client-templates-product-card-html"><span class="toc-number">1.1.3.</span> <span class="toc-text">client/templates/product-card.html</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Una-lista-de-productos-a-lo-burro"><span class="toc-number">2.</span> <span class="toc-text">Una lista de productos: a lo burro</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lib-collections-products-js"><span class="toc-number">2.1.</span> <span class="toc-text">lib/collections/products.js</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AtmosphereJS-paquetes-para-Meteor"><span class="toc-number">3.</span> <span class="toc-text">AtmosphereJS: paquetes para Meteor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Iron-Router"><span class="toc-number">3.1.</span> <span class="toc-text">Iron Router</span></a></li></ol></li></ol></div><div id="actions-footer"><ul><li id="toc"><a class="icon" href="#actions-footer"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li><li id="top" style="display:none"><a class="icon" href="#"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li><li id="menu"><a class="icon" href="#actions-footer"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li></ul></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2017 Emilio J. Grande</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></nav></div></footer><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/meslo-LG/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/js/main.js"></script></body></html>