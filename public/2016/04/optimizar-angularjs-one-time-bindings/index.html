<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="AngularJS, y las aplicaciones JavaScript del lado del cliente en general no se caracterizan por su ligereza en el consumo de memoria. Una de las características que incrementa el consumo de la misma e"><meta property="og:type" content="article"><meta property="og:title" content="Optimizar AngularJS: one-time bindings"><meta property="og:url" content="https://github.com/er1x/2016/04/optimizar-angularjs-one-time-bindings/index.html"><meta property="og:site_name" content="Emilio J. Grande | Web Developer"><meta property="og:description" content="AngularJS, y las aplicaciones JavaScript del lado del cliente en general no se caracterizan por su ligereza en el consumo de memoria. Una de las características que incrementa el consumo de la misma e"><meta property="og:image" content="https://github.com/er1x/images/2016-04/t5yjwmlkrjbcjcwpxtxa.jpg"><meta property="og:image" content="https://github.com/er1x/images/2016-04/two-way-watchers.PNG"><meta property="og:image" content="https://github.com/er1x/images/2016-04/two-way.png"><meta property="og:image" content="https://github.com/er1x/images/2016-04/one-time-watchers.PNG"><meta property="og:image" content="https://github.com/er1x/images/2016-04/one-time.png"><meta property="og:updated_time" content="2017-02-25T16:37:21.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Optimizar AngularJS: one-time bindings"><meta name="twitter:description" content="AngularJS, y las aplicaciones JavaScript del lado del cliente en general no se caracterizan por su ligereza en el consumo de memoria. Una de las características que incrementa el consumo de la misma e"><meta name="twitter:image" content="https://github.com/er1x/images/2016-04/t5yjwmlkrjbcjcwpxtxa.jpg"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><title>Optimizar AngularJS: one-time bindings</title><style type="text/css">.content h1,.fa,body{-moz-osx-font-smoothing:grayscale}.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased}.content h1,.content h2,.content strong{font-weight:700}.highlight,body,pre{font-family:Menlo,"Meslo LG",monospace}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-tag:before{content:"\f02b"}.fa-list:before{content:"\f03a"}.fa-chevron-up:before{content:"\f077"}.fa-bars:before{content:"\f0c9"}#header-post #toc .toc-level-2:before,.article-tag .tag-link:before,article .content h2:before{content:"#"}*,:after,:before{box-sizing:border-box}.content h1,body{-webkit-font-smoothing:antialiased}body{text-rendering:geometricPrecision}.my4{margin-top:4rem;margin-bottom:4rem}.mx-auto{margin-left:auto;margin-right:auto}.px2{padding-left:1rem;padding-right:1rem}.content h1{letter-spacing:.01em;font-size:1.5em;font-style:normal;color:#2bbc8a;margin-top:3rem;margin-bottom:1rem;display:block}.content h2{position:relative;font-size:1rem;text-transform:none;letter-spacing:normal;margin-top:2rem;margin-bottom:.5rem;color:#eee;display:block}#header-post #nav ul li{border-right:1px dotted #2bbc8a}.content em{font-style:italic}.content table{width:100%;font-size:12px;border-collapse:collapse;text-align:left}.content td{border-bottom:none;padding:9px 8px 0}html{height:100%;border-top:2px solid #c9cacc}body{line-height:1.725;color:#c9cacc;background-color:#1d1f21;font-size:14px;font-weight:400;min-height:100%;display:flex;flex-direction:column}.content{flex:1}.content p{-moz-hyphens:auto;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.content pre{-moz-hyphens:manual;-ms-hyphens:manual;-webkit-hyphens:manual;hyphens:manual}.content a{text-decoration:none;color:#c9cacc;background-repeat:repeat-x;background-position:bottom;background-size:100% 6px;background-image:linear-gradient(transparent,transparent 5px,#c9cacc 5px,#c9cacc)}#header-post a,.content h2 a{color:inherit;background:0 0;text-decoration:none}#header-post #nav ul li:last-child a,#header-post ul li:last-child{margin-right:0}.width{width:100%;max-width:39rem}@media (max-width:480px){.my4{margin-top:2rem;margin-bottom:2rem}}#header-post #nav ul{line-height:15px}#header-post #nav{font-style:normal;font-weight:200;letter-spacing:.01em;font-size:.8rem;color:#2bbc8a}#header-post{position:fixed;top:2rem;right:2rem;display:inline-block;float:right}#header-post ol{list-style-type:none}#header-post ul{list-style-type:none;margin:0;padding:0;display:inline-block}#header-post ul li{margin-right:15px;display:inline-block;vertical-align:middle}#header-post #menu-icon,#header-post #menu-icon-tablet{float:right;margin-left:15px}#header-post #top-icon-tablet{margin-left:15px;bottom:2rem;right:2rem;position:fixed}#header-post #menu{visibility:hidden}#header-post #nav ul a{margin-right:15px;color:color-accent}#header-post #nav ul li:last-child{border-right:0;margin-right:0}#header-post #toc{clear:both;text-align:right;padding-top:1rem}#header-post #toc .toc-number{display:none}#header-post #toc .toc-level-2{font-size:.8rem;color:#c9cacc}#header-post #toc .toc-level-2:before{color:#2bbc8a}@media screen and (max-width:500px){#header-post{display:none}}@media screen and (max-width:900px){#header-post #menu-icon{display:none}}@media screen and (max-width:1199px){#header-post #toc{display:none}}@media screen and (min-width:900px){#header-post #menu-icon-tablet,#header-post #top-icon-tablet{display:none!important}}#footer-post{bottom:0;left:0;right:0;position:fixed;width:100%;z-index:5000000;background:#212326;border-top:1px solid #666673}#footer-post a,#footer-post a.icon{background:0 0}#footer-post a{color:inherit;text-decoration:none}#footer-post #nav-footer{margin-left:1rem;margin-right:1rem;text-align:center}#footer-post #nav-footer a{color:#2bbc8a;font-size:1rem}#footer-post #actions-footer ul,#footer-post #nav-footer ul{list-style-type:none;margin:0;padding:0;display:table;width:100%}#footer-post #nav-footer ul li{display:inline-table;width:20%;padding:10px;vertical-align:middle}#footer-post #actions-footer{text-align:center;margin-top:1rem;margin-bottom:1rem;width:100%}#footer-post #actions-footer a{color:#2bbc8a}#footer-post #actions-footer ul li{display:table-cell;vertical-align:middle}#footer-post #toc-footer .toc-number{display:none}#footer-post #toc-footer{clear:both;text-align:left;padding-top:1rem}#footer-post #toc-footer ol{list-style-type:none;padding-left:20px}#footer-post #toc-footer ol li{line-height:30px}#footer-post #toc-footer .toc-level-2{font-size:.8rem;color:#c9cacc}#footer-post #toc-footer .toc-level-2:before{content:"#";color:#2bbc8a}@media screen and (min-width:500px){#footer-post-container{display:none}}article header .posttitle{margin-top:0;margin-bottom:0;text-transform:none;font-size:1.5em;line-height:1.25}article header .meta{margin-top:0;margin-bottom:1rem}article header .meta *{color:#ccc;font-size:.85rem}article header .author{text-transform:uppercase;letter-spacing:.01em;font-weight:700}article header .postdate{display:inline}article .content h2:before{color:#2bbc8a;position:absolute;left:-1rem;top:-4px;font-size:1.2rem;font-weight:700}article .content img{max-width:100%;height:auto;display:block;margin:auto}.posttitle{text-transform:none;font-size:1.5em;line-height:1.25}@media (min-width:480px){p{text-align:justify}.article-tag{display:inline}.article-tag:before{content:"|"}}.highlight,pre{overflow-x:auto}.highlight{color:#d1d9e1}.highlight .code .keyword{color:#c9c}.highlight .code .string{color:#8abeb7}.highlight .code .name{color:#b5bd68;font-weight:700}.highlight .code .attr{color:#81a2be}pre{font-size:13px;padding:10px 15px 0;line-height:22px;-webkit-border-radius:4px;border-radius:4px;border:1px dotted #666}.highlight{background:#212326;-webkit-border-radius:4px;border-radius:4px;padding:10px 15px;margin:1rem 0}.highlight pre{padding:0;border:none;background:0 0}.highlight table{width:auto}.highlight td.gutter{text-align:right;padding-right:20px;display:none}</style></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></span><br><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ejemplo-con-Two-way-databinding"><span class="toc-number">1.</span> <span class="toc-text">Ejemplo con Two-way databinding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ejemplo-con-One-time-databinding"><span class="toc-number">2.</span> <span class="toc-text">Ejemplo con One-time databinding</span></a></li></ol></div></span></div><div class="content index width mx-auto px2 my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Optimizar AngularJS: one-time bindings</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Emilio J. Grande | Web Developer</span></span><div class="postdate"><time datetime="2016-04-21T18:30:00.000Z" itemprop="datePublished">21-04-2016</time></div><div class="article-tag"><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/angular/">angular</a></div></div></header><div class="content" itemprop="articleBody"><p><img src="/images/2016-04/t5yjwmlkrjbcjcwpxtxa.jpg" alt=""></p><p>AngularJS, y las <strong>aplicaciones JavaScript</strong> del lado del cliente en general <strong>no se caracterizan por su ligereza en el consumo de memoria</strong>. Una de las características que incrementa el consumo de la misma es el data-binding, es decir, la característica que hace que cuando cambien los datos en el modelo, la vista se actualice de forma automática.</p><p><strong>Una de las formas de optimizar AngularJS en cuanto a consumo de memoria es utilizar one-time bindings</strong> (lo traduciría como enlaces de una sola vez, pero me suena fatal 😛 ).</p><h2 id="Ejemplo-con-Two-way-databinding"><a href="#Ejemplo-con-Two-way-databinding" class="headerlink" title="Ejemplo con Two-way databinding"></a>Ejemplo con <em>Two-way databinding</em></h2><p>En este código que te presento a continuación tienes una aplicación de ejemplo en la que se presentan 10000 variables de un Array, en un listado:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">ng-app</span>=<span class="string">"app"</span> <span class="attr">ng-controller</span>=<span class="string">"MainController as main"</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"el in main.data"</span>&gt;</span>&#123;&#123; el.foo &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.5/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="keyword">var</span> data = []</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</div><div class="line">      data.push(&#123;<span class="attr">foo</span>: i&#125;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    angular</div><div class="line">      .module(<span class="string">'app'</span>, [])</div><div class="line">      .controller(<span class="string">'MainController'</span>, [<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">this</span>.data = data</div><div class="line">      &#125;])</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure><p>Aquí, Angular está vigilando cambios por el propio array y cada uno de los 10000 elementos que estamos representando en la lista, dando como resultado <strong>10001 watchers registrados por AngularJS</strong> para vigilar los cambios en cada una de estas variables:</p><p><img src="/images/2016-04/two-way-watchers.PNG" alt="Mogollón de watchers"></p><p>Y, por supuesto, <strong>el consumo de memoria se incrementa</strong>:</p><p><img src="/images/2016-04/two-way.png" alt="Consumo de memoria con two-way binding"></p><h2 id="Ejemplo-con-One-time-databinding"><a href="#Ejemplo-con-One-time-databinding" class="headerlink" title="Ejemplo con One-time databinding"></a>Ejemplo con <em>One-time databinding</em></h2><p>Si queremos optimizar AngularJS podemos utilizar el mecanismo de one-time binding en los lugares donde no necesitemos que se observen cambios en las variables. Esto se hace poniendo <strong>dos puntos (::) delante de la variable</strong> que en principio sería observada:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"el in ::main.data"</span>&gt;</span>&#123;&#123; ::el.foo &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure><p>En este caso estaríamos reduciendo en 10001 el número de watchers, ya que Angular simplemente pone el valor una vez en la vista y luego se olvida aunque se produzcan actualizaciones.</p><p><img src="/images/2016-04/one-time-watchers.PNG" alt="Sin watchers"></p><p>Esto, tiene su reflejo en el consumo de memoria:</p><p><img src="/images/2016-04/one-time.png" alt="Consumo de memoria con one-time binding"></p><p>Aunque este ejemplo es un poco exagerado, como ves ahora <strong>estamos consumiendo la mitad de memoria</strong> en esa vista, ya que estamos simplemente representando valores que no se van a actualizar.</p><hr><p>Si alguna vez te encuentras con con un consumo de memoria excesivo en tu aplicación o simplemente quieres optimizarla en cuanto a uso de memoria, es interesante que le eches un vistazo a los atributos de scope de Angular que están siendo vigilados y utilizar este mecanismo para eliminar estos watchers.</p></div></article></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ejemplo-con-Two-way-databinding"><span class="toc-number">1.</span> <span class="toc-text">Ejemplo con Two-way databinding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ejemplo-con-One-time-databinding"><span class="toc-number">2.</span> <span class="toc-text">Ejemplo con One-time databinding</span></a></li></ol></div><div id="actions-footer"><ul><li id="toc"><a class="icon" href="#actions-footer"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li><li id="top" style="display:none"><a class="icon" href="#"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li><li id="menu"><a class="icon" href="#actions-footer"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li></ul></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2017 Emilio J. Grande</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></nav></div></footer><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/meslo-LG/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/js/main.js"></script></body></html>