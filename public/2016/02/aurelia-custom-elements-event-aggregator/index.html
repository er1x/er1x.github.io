<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Como viene siendo habitual en los frameworks JavaScript de última generación, tenemos la posibilidad de crear elementos HTML personalizados. Así, con Aurelia podemos crear Custom Elements, que nos per"><meta property="og:type" content="article"><meta property="og:title" content="Aurelia - Cómo crear Custom Elements y usar Event Aggregator"><meta property="og:url" content="https://github.com/er1x/2016/02/aurelia-custom-elements-event-aggregator/index.html"><meta property="og:site_name" content="Emilio J. Grande | Web Developer"><meta property="og:description" content="Como viene siendo habitual en los frameworks JavaScript de última generación, tenemos la posibilidad de crear elementos HTML personalizados. Así, con Aurelia podemos crear Custom Elements, que nos per"><meta property="og:image" content="https://github.com/er1x/images/2016-02/aur-eventagg.jpg"><meta property="og:image" content="https://github.com/er1x/images/2016-02/custom-switches.png"><meta property="og:image" content="https://github.com/er1x/images/2016-02/switches-lights.png"><meta property="og:updated_time" content="2017-03-11T12:54:27.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Aurelia - Cómo crear Custom Elements y usar Event Aggregator"><meta name="twitter:description" content="Como viene siendo habitual en los frameworks JavaScript de última generación, tenemos la posibilidad de crear elementos HTML personalizados. Así, con Aurelia podemos crear Custom Elements, que nos per"><meta name="twitter:image" content="https://github.com/er1x/images/2016-02/aur-eventagg.jpg"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><title>Aurelia - Cómo crear Custom Elements y usar Event Aggregator</title><style type="text/css">.content h1,.fa,body{-moz-osx-font-smoothing:grayscale}.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased}.content h1,.content h2,.content strong{font-weight:700}body,pre{font-family:Menlo,"Meslo LG",monospace}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-tag:before{content:"\f02b"}.fa-list:before{content:"\f03a"}.fa-chevron-up:before{content:"\f077"}.fa-bars:before{content:"\f0c9"}#header-post #toc .toc-level-2:before,.article-tag .tag-link:before,article .content h2:before{content:"#"}*,:after,:before{box-sizing:border-box}.content h1,body{-webkit-font-smoothing:antialiased}.my4{margin-top:4rem;margin-bottom:4rem}.mx-auto{margin-left:auto;margin-right:auto}.px2{padding-left:1rem;padding-right:1rem}.content h1{letter-spacing:.01em;font-size:1.5em;font-style:normal;color:#2bbc8a;margin-top:3rem;margin-bottom:1rem;display:block}.content h2{position:relative;font-size:1rem;text-transform:none;letter-spacing:normal;margin-top:2rem;margin-bottom:.5rem;color:#eee;display:block}#header-post #nav ul li{border-right:1px dotted #2bbc8a}.content em{font-style:italic}body{text-rendering:geometricPrecision;line-height:1.725;color:#c9cacc;background-color:#1d1f21;font-size:14px;font-weight:400;min-height:100%;display:flex;flex-direction:column}.content td{border-bottom:none;padding:9px 8px 0}html{height:100%;border-top:2px solid #c9cacc}.content{flex:1}.content p{-moz-hyphens:auto;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.content pre{-moz-hyphens:manual;-ms-hyphens:manual;-webkit-hyphens:manual;hyphens:manual}.content a{text-decoration:none;color:#c9cacc;background-repeat:repeat-x;background-position:bottom;background-size:100% 6px;background-image:linear-gradient(transparent,transparent 5px,#c9cacc 5px,#c9cacc)}#header-post a,.content h2 a{color:inherit;background:0 0;text-decoration:none}#header-post #nav ul li:last-child a,#header-post ul li:last-child{margin-right:0}.width{width:100%;max-width:39rem}@media (max-width:480px){.my4{margin-top:2rem;margin-bottom:2rem}}#header-post #nav ul{line-height:15px}#header-post #nav{font-style:normal;font-weight:200;letter-spacing:.01em;font-size:.8rem;color:#2bbc8a}#header-post{position:fixed;top:2rem;right:2rem;display:inline-block;float:right}#header-post ol{list-style-type:none}#header-post ul{list-style-type:none;margin:0;padding:0;display:inline-block}#header-post ul li{margin-right:15px;display:inline-block;vertical-align:middle}#header-post #menu-icon,#header-post #menu-icon-tablet{float:right;margin-left:15px}#header-post #top-icon-tablet{margin-left:15px;bottom:2rem;right:2rem;position:fixed}#header-post #menu{visibility:hidden}#header-post #nav ul a{margin-right:15px;color:color-accent}#header-post #nav ul li:last-child{border-right:0;margin-right:0}#header-post #toc{clear:both;text-align:right;padding-top:1rem}#header-post #toc .toc-number{display:none}#header-post #toc .toc-level-2{font-size:.8rem;color:#c9cacc}#header-post #toc .toc-level-2:before{color:#2bbc8a}#header-post #toc .toc-level-3{font-size:.7rem;color:#b3b3b3}#header-post #toc .toc-level-4{font-size:.4rem;color:#666}@media screen and (max-width:500px){#header-post{display:none}}@media screen and (max-width:900px){#header-post #menu-icon{display:none}}@media screen and (max-width:1199px){#header-post #toc{display:none}}@media screen and (min-width:900px){#header-post #menu-icon-tablet,#header-post #top-icon-tablet{display:none!important}}#footer-post{bottom:0;left:0;right:0;position:fixed;width:100%;z-index:5000000;background:#212326;border-top:1px solid #666673}#footer-post a,#footer-post a.icon,.highlight pre{background:0 0}#footer-post a{color:inherit;text-decoration:none}#footer-post #nav-footer{margin-left:1rem;margin-right:1rem;text-align:center}#footer-post #nav-footer a{color:#2bbc8a;font-size:1rem}#footer-post #actions-footer ul,#footer-post #nav-footer ul{list-style-type:none;margin:0;padding:0;display:table;width:100%}#footer-post #nav-footer ul li{display:inline-table;width:20%;padding:10px;vertical-align:middle}#footer-post #actions-footer{text-align:center;margin-top:1rem;margin-bottom:1rem;width:100%}#footer-post #actions-footer a{color:#2bbc8a}#footer-post #actions-footer ul li{display:table-cell;vertical-align:middle}#footer-post #toc-footer .toc-level-4,#footer-post #toc-footer .toc-number{display:none}#footer-post #toc-footer{clear:both;text-align:left;padding-top:1rem}#footer-post #toc-footer ol{list-style-type:none;padding-left:20px}#footer-post #toc-footer ol li{line-height:30px}#footer-post #toc-footer .toc-level-2{font-size:.8rem;color:#c9cacc}#footer-post #toc-footer .toc-level-2:before{content:"#";color:#2bbc8a}#footer-post #toc-footer .toc-level-3{font-size:.7rem;color:#666;line-height:15px}@media screen and (min-width:500px){#footer-post-container{display:none}}article header .posttitle{margin-top:0;margin-bottom:0;text-transform:none;font-size:1.5em;line-height:1.25}article header .meta{margin-top:0;margin-bottom:1rem}article header .meta *{color:#ccc;font-size:.85rem}article header .author{text-transform:uppercase;letter-spacing:.01em;font-weight:700}article header .postdate{display:inline}article .content h2:before{color:#2bbc8a;position:absolute;left:-1rem;top:-4px;font-size:1.2rem;font-weight:700}article .content img{max-width:100%;height:auto;display:block;margin:auto}.posttitle{text-transform:none;font-size:1.5em;line-height:1.25}@media (min-width:480px){p{text-align:justify}.article-tag{display:inline}.article-tag:before{content:"|"}}pre{overflow-x:auto;font-size:13px;padding:10px 15px 0;line-height:22px;-webkit-border-radius:4px;border-radius:4px;border:1px dotted #666}.highlight pre{padding:0;border:none}.highlight td.gutter{text-align:right;padding-right:20px;display:none}</style></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></span><br><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Aurelia-Custom-Elements"><span class="toc-number">1.</span> <span class="toc-text">Aurelia Custom Elements</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#switch-js"><span class="toc-number">1.1.</span> <span class="toc-text">switch.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#switch-html"><span class="toc-number">1.2.</span> <span class="toc-text">switch.html</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Aurelia-Event-Aggregator"><span class="toc-number">2.</span> <span class="toc-text">Aurelia Event Aggregator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Modificaciones-del-elemento-Switch"><span class="toc-number">2.1.</span> <span class="toc-text">Modificaciones del elemento Switch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Elemento-Light"><span class="toc-number">2.2.</span> <span class="toc-text">Elemento Light</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#light-html"><span class="toc-number">2.2.1.</span> <span class="toc-text">light.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#light-js"><span class="toc-number">2.2.2.</span> <span class="toc-text">light.js</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text"></span></a></li></ol></div></span></div><div class="content index width mx-auto px2 my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Aurelia - Cómo crear Custom Elements y usar Event Aggregator</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Emilio J. Grande | Web Developer</span></span><div class="postdate"><time datetime="2016-02-29T06:00:00.000Z" itemprop="datePublished">29-02-2016</time></div><div class="article-tag"><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/aurelia/">aurelia</a>, <a class="tag-link" href="/tags/es2015/">es2015</a></div></div></header><div class="content" itemprop="articleBody"><p><img src="/images/2016-02/aur-eventagg.jpg" alt="Aurelia CustomElements &amp; Event Aggregator"></p><p>Como viene siendo habitual en los frameworks JavaScript de última generación, tenemos la posibilidad de crear elementos HTML personalizados. Así, <strong>con <a href="http://aurelia.io/" target="_blank" rel="external">Aurelia</a> podemos crear Custom Elements</strong>, que nos permiten hacer el HTML más legible y modular.</p><p>En este tutorial de Aurelia veremos <strong>cómo crear estos <a href="http://blog.durandal.io/2015/04/24/aurelia-custom-elements-and-content-selectors/" target="_blank" rel="external">Custom Elements</a>, y utilizar <a href="https://github.com/aurelia/event-aggregator">Event Agregator</a></strong>, una pequeña biblioteca que nos permite comunicar elementos de la página mediante el mecanismo <em>publish/subscribe</em>.</p><h2 id="Aurelia-Custom-Elements"><a href="#Aurelia-Custom-Elements" class="headerlink" title="Aurelia Custom Elements"></a>Aurelia Custom Elements</h2><p>Vamos a crear unos interruptores (switch) y a permitir usarlos en una aplicación, partiendo del <strong><a href="/2016/02/empezar-desarrollo-spa-con-aurelia/">Starter Kit de Aurelia</a></strong> como base.</p><p>Como ya sabes si viste alguno de los <a href="/2015/07/introduccion-aurelia-framework/">tutoriales anteriores de Aurelia</a>, crearemos estos elementos con dos ficheros: switch.html y switch.js.</p><h3 id="switch-js"><a href="#switch-js" class="headerlink" title="switch.js"></a>switch.js</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;customElement&#125; <span class="keyword">from</span> <span class="string">'aurelia-framework'</span></div><div class="line"></div><div class="line">@customElement(<span class="string">'switch'</span>)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Switch</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.enabled = <span class="literal">false</span></div><div class="line">  &#125;</div><div class="line">  toggle() &#123;</div><div class="line">    <span class="keyword">this</span>.enabled = !<span class="keyword">this</span>.enabled</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Como puedes ver, en <a href="http://aurelia.io/" target="_blank" rel="external">Aurelia</a> es todo es <a href="https://babeljs.io/docs/learn-es2015/" target="_blank" rel="external">ECMAScript 6</a>/7, que es compilado a ES5 con <a href="https://babeljs.io/" target="_blank" rel="external">Babel</a>. En este caso hemos hecho lo siguiente:</p><ul><li>Importar <em>customElement</em> del framework Aurelia.</li><li>Crear una clase <em>Switch</em> y especificar mediante el decorator customElement, que “switch” será el elemento HTML que vamos a crear.</li><li>En el constructor creamos una propiedad enabled, que indicará si el interruptor está activo. Por defecto a false.</li><li>Por último creamos un método de la clase Switch para activar y desactivar el interruptor.</li></ul><h3 id="switch-html"><a href="#switch-html" class="headerlink" title="switch.html"></a>switch.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">require</span> <span class="attr">from</span>=<span class="string">"/styles/switch.css"</span>&gt;</span><span class="tag">&lt;/<span class="name">require</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'switch'</span> <span class="attr">click.trigger</span>=<span class="string">"toggle()"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'switch__off'</span> <span class="attr">class.bind</span>=<span class="string">"enabled ? 'switch__off--hide' : ''"</span>&gt;</span>OFF<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'switch__glow'</span> <span class="attr">class.bind</span>=<span class="string">"enabled ? '' : 'switch__glow--hide'"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'switch__button'</span> <span class="attr">class.bind</span>=<span class="string">"enabled ? 'switch__button--hide' : ''"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'switch__on'</span> <span class="attr">class.bind</span>=<span class="string">"enabled ? '' : 'switch__on--hide'"</span>&gt;</span>ON<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p>Y esta es la plantilla:</p><ul><li>Se define entre las etiquetas <strong>template</strong> (¡sí, <a href="/2015/12/megatutorial-meteor-uno/">igual que en Meteor</a>!).</li><li>Creamos una serie de divs que son las que muestran el estado del interruptor. Esto lleva a requerir un CSS para este switch, lo que hacemos con la <strong>etiqueta require y el atributo from</strong>.</li><li>Indicamos que al hacer click debe dispararse el método toogle, mediante <strong>click.trigger</strong>.</li><li>Por último <strong>hacemos un bind de la class</strong>, para asignar clases CSS adicionales dependiendo de si el interruptor está activo o no.</li></ul><p>¿Sencillo no? ¡Pues ahora a usar nuestro nuevo elemento!</p><p>Para ello incluiremos varios “switch” en el elemento principal de la aplicación, en src/app.html:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">require</span> <span class="attr">from</span>=<span class="string">"./switch"</span>&gt;</span><span class="tag">&lt;/<span class="name">require</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col1"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">switch</span>&gt;</span><span class="tag">&lt;/<span class="name">switch</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">switch</span>&gt;</span><span class="tag">&lt;/<span class="name">switch</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">switch</span>&gt;</span><span class="tag">&lt;/<span class="name">switch</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">switch</span>&gt;</span><span class="tag">&lt;/<span class="name">switch</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p>Con todo esto, <strong>nuestros custom elements de Aurelia tienen esta pinta</strong>:</p><p><img src="/images/2016-02/custom-switches.png" alt="Custom switches"></p><h2 id="Aurelia-Event-Aggregator"><a href="#Aurelia-Event-Aggregator" class="headerlink" title="Aurelia Event Aggregator"></a>Aurelia Event Aggregator</h2><p>Cuando me puse a picar este ejemplo pensé que sería chulo que estos interruptores controlaran algo, por ejemplo, unas bombillas, y <strong>comunicar estos elementos con el <a href="https://github.com/aurelia/event-aggregator">Event Aggregator</a> de Aurelia</strong>. El Event Aggregator es un sistema ligero de comunicación tipo <em>publish/subscribe</em>.</p><h3 id="Modificaciones-del-elemento-Switch"><a href="#Modificaciones-del-elemento-Switch" class="headerlink" title="Modificaciones del elemento Switch"></a>Modificaciones del elemento Switch</h3><p>Tenemos que añadir los eventos al switch, vamos a ello:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;customElement, inject, bindable&#125; <span class="keyword">from</span> <span class="string">'aurelia-framework'</span></div><div class="line"><span class="keyword">import</span> &#123;EventAggregator&#125; <span class="keyword">from</span> <span class="string">'aurelia-event-aggregator'</span></div><div class="line"></div><div class="line">@customElement(<span class="string">'switch'</span>)</div><div class="line">@inject(EventAggregator)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Switch</span> </span>&#123;</div><div class="line">  @bindable number</div><div class="line">  <span class="keyword">constructor</span>(eventAggregator) &#123;</div><div class="line">    <span class="keyword">this</span>.enabled = <span class="literal">false</span></div><div class="line">    <span class="keyword">this</span>.eventAggregator = eventAggregator</div><div class="line">  &#125;</div><div class="line">  toggle() &#123;</div><div class="line">    <span class="keyword">this</span>.enabled = !<span class="keyword">this</span>.enabled</div><div class="line">    <span class="keyword">this</span>.eventAggregator.publish(<span class="string">`switch-<span class="subst">$&#123;<span class="keyword">this</span>.number&#125;</span>`</span>, <span class="keyword">this</span>.enabled)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Con respecto al código anterior, esto es lo que ha cambiado:</p><ul><li>Importamos <strong>inject y bindable de aurelia-framework</strong>. Inject lo necesitaremos para inyectar la dependencia EventAggregator en la clase switch (podríamos pasar de ello si no quisiéramos usar inyección de dependencias). Bindable lo necesitaremos para añadir un atributo extra al interruptor, que será un número que lo identifique.</li><li>Importamos EventAggregator.</li><li><strong>Inyectamos EventAggregator</strong> mediante el decorator “\@inject”.</li><li>Asignamos el atributo HTML number a una propiedad.</li><li>En el constructor, guardamos el eventAggregator.</li><li>En el método toggle, además de cambiar el estado del interruptor, <strong>utilizamos eventAggregator para publicar un evento</strong> <em>switch-númeroDelSwitch</em>. A quien se suscriba a este evento le llegará también el estado del interruptor (this.enabled) como información adicional.</li></ul><p>A partir de ahora, los switch se crearían así:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">switch</span> number=<span class="string">"0"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">switch</span>&gt;</span></span></div></pre></td></tr></table></figure><h3 id="Elemento-Light"><a href="#Elemento-Light" class="headerlink" title="Elemento Light"></a>Elemento <em>Light</em></h3><p>Vamos a crear unos <em>custom element</em> sencillitos que enseñen un pequeño circulito amarillo, a modo de bombilla.</p><h4 id="light-html"><a href="#light-html" class="headerlink" title="light.html"></a>light.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">require</span> <span class="attr">from</span>=<span class="string">"/styles/light.css"</span>&gt;</span><span class="tag">&lt;/<span class="name">require</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"light"</span> <span class="attr">class.bind</span>=<span class="string">"on? '' : 'light--off'"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p>No hay mucho que decir en este ejemplo, ya que lo hemos visto todo con el anterior. Importamos un CSS para la luz y le cambiamos la clase dependiendo del estado del atributo ON.</p><h4 id="light-js"><a href="#light-js" class="headerlink" title="light.js"></a>light.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;customElement, inject, bindable&#125; <span class="keyword">from</span> <span class="string">'aurelia-framework'</span></div><div class="line"><span class="keyword">import</span> &#123;EventAggregator&#125; <span class="keyword">from</span> <span class="string">'aurelia-event-aggregator'</span></div><div class="line"></div><div class="line">@customElement(<span class="string">'light'</span>)</div><div class="line">@inject(EventAggregator)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Light</span> </span>&#123;</div><div class="line">  @bindable number</div><div class="line">  <span class="keyword">constructor</span>(eventAggregator) &#123;</div><div class="line">    <span class="keyword">this</span>.on = <span class="literal">false</span></div><div class="line">    <span class="keyword">this</span>.eventAggregator = eventAggregator</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  attached() &#123;</div><div class="line">    <span class="keyword">this</span>.eventAggregator.subscribe(<span class="string">`switch-<span class="subst">$&#123;<span class="keyword">this</span>.number&#125;</span>`</span>, switchEnabled =&gt; &#123;</div><div class="line">      <span class="keyword">if</span> (switchEnabled) &#123;</div><div class="line">        <span class="keyword">this</span>.on = <span class="literal">true</span></div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">this</span>.on = <span class="literal">false</span></div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>En este caso los imports son exactamente iguales que en el otro custom element. La diferencia ahora está en el método attached.</p><p>Attached es un método especial que se ejecuta cuando la vista se ha agregado al DOM, y en este caso lo que queremos que ocurra es que <strong>el elemento light se suscriba al evento <em>switch-númeroDelSwitch</em></strong>, mediante el método subscribe de eventAggregator.</p><p>El resultado tiene esta pinta:</p><h2><a href="#" class="headerlink"></a><img src="/images/2016-02/switches-lights.png" alt="Custom switches"></h2><p>En este tutorial de <a href="http://aurelia.io/" target="_blank" rel="external">Aurelia</a> hemos visto lo sencillo que es crear elementos HTML personalizados (<a href="http://blog.durandal.io/2015/04/24/aurelia-custom-elements-and-content-selectors/" target="_blank" rel="external">Custom Elements</a>) y cómo podemos utilizar <a href="https://github.com/aurelia/event-aggregator">EventAggregator</a> para realizar una comunicación sencilla en la aplicación.</p><p>Y por último, que se me olvidaba :P, el código <a href="https://github.com/er1x/ce-ea-sample">lo tienes en Github</a>, por si quieres echarle un vistazo ;)</p><p>¿A ti qué te ha parecido? ¿Fácil, difícil? ¿Te gusta más la sintaxis de React o Angular2? A mí desde luego no ^^</p><p>¡Buena semana!</p><hr><p>Imagen del post por <a href="https://unsplash.com/madebyvadim" target="_blank" rel="external">Vadim Sherbakov</a></p></div></article></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Aurelia-Custom-Elements"><span class="toc-number">1.</span> <span class="toc-text">Aurelia Custom Elements</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#switch-js"><span class="toc-number">1.1.</span> <span class="toc-text">switch.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#switch-html"><span class="toc-number">1.2.</span> <span class="toc-text">switch.html</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Aurelia-Event-Aggregator"><span class="toc-number">2.</span> <span class="toc-text">Aurelia Event Aggregator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Modificaciones-del-elemento-Switch"><span class="toc-number">2.1.</span> <span class="toc-text">Modificaciones del elemento Switch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Elemento-Light"><span class="toc-number">2.2.</span> <span class="toc-text">Elemento Light</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#light-html"><span class="toc-number">2.2.1.</span> <span class="toc-text">light.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#light-js"><span class="toc-number">2.2.2.</span> <span class="toc-text">light.js</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text"></span></a></li></ol></div><div id="actions-footer"><ul><li id="toc"><a class="icon" href="#actions-footer"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li><li id="top" style="display:none"><a class="icon" href="#"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li><li id="menu"><a class="icon" href="#actions-footer"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li></ul></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2017 Emilio J. Grande</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></nav></div></footer><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/meslo-LG/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/js/main.js"></script></body></html>