<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="JavaScript avanza tan deprisa que es complicado estar al día de todas las cosas nuevas que salen. Uno de las novedades más interesantes que llegará próximamente es el objeto Proxy.Proxy en ES6MDN defi"><meta property="og:type" content="article"><meta property="og:title" content="Jugando con el objeto Proxy de ECMAScript6"><meta property="og:url" content="https://github.com/er1x/2016/02/como-usar-proxy-es6/index.html"><meta property="og:site_name" content="Emilio J. Grande | Web Developer"><meta property="og:description" content="JavaScript avanza tan deprisa que es complicado estar al día de todas las cosas nuevas que salen. Uno de las novedades más interesantes que llegará próximamente es el objeto Proxy.Proxy en ES6MDN defi"><meta property="og:image" content="https://github.com/er1x/images/2016-02/proxy.jpg"><meta property="og:image" content="https://github.com/er1x/images/2016-02/proxy_example.PNG"><meta property="og:image" content="https://github.com/er1x/images/2016-02/aware_object.png"><meta property="og:updated_time" content="2017-03-11T12:54:27.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Jugando con el objeto Proxy de ECMAScript6"><meta name="twitter:description" content="JavaScript avanza tan deprisa que es complicado estar al día de todas las cosas nuevas que salen. Uno de las novedades más interesantes que llegará próximamente es el objeto Proxy.Proxy en ES6MDN defi"><meta name="twitter:image" content="https://github.com/er1x/images/2016-02/proxy.jpg"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><title>Jugando con el objeto Proxy de ECMAScript6</title><style type="text/css">.content h1,.fa,body{-moz-osx-font-smoothing:grayscale}.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased}.content h1,.content h2,.content strong{font-weight:700}.highlight,body,pre{font-family:Menlo,"Meslo LG",monospace}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-tag:before{content:"\f02b"}.fa-list:before{content:"\f03a"}.fa-chevron-up:before{content:"\f077"}.fa-bars:before{content:"\f0c9"}#header-post #toc .toc-level-2:before,.article-tag .tag-link:before,article .content h2:before{content:"#"}*,:after,:before{box-sizing:border-box}.content h1,body{-webkit-font-smoothing:antialiased}body{text-rendering:geometricPrecision}.my4{margin-top:4rem;margin-bottom:4rem}.mx-auto{margin-left:auto;margin-right:auto}.px2{padding-left:1rem;padding-right:1rem}.content h1{letter-spacing:.01em;font-size:1.5em;font-style:normal;color:#2bbc8a;margin-top:3rem;margin-bottom:1rem;display:block}.content h2{position:relative;font-size:1rem;text-transform:none;letter-spacing:normal;margin-top:2rem;margin-bottom:.5rem;color:#eee;display:block}#header-post #nav ul li{border-right:1px dotted #2bbc8a}.content em{font-style:italic}.content table{width:100%;font-size:12px;border-collapse:collapse;text-align:left}.content td{border-bottom:none;padding:9px 8px 0}html{height:100%;border-top:2px solid #c9cacc}body{line-height:1.725;color:#c9cacc;background-color:#1d1f21;font-size:14px;font-weight:400;min-height:100%;display:flex;flex-direction:column}.content{flex:1}.content p{-moz-hyphens:auto;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.content pre{-moz-hyphens:manual;-ms-hyphens:manual;-webkit-hyphens:manual;hyphens:manual}.content a{text-decoration:none;color:#c9cacc;background-repeat:repeat-x;background-position:bottom;background-size:100% 6px;background-image:linear-gradient(transparent,transparent 5px,#c9cacc 5px,#c9cacc)}#header-post a,.content h2 a{color:inherit;background:0 0;text-decoration:none}#header-post #nav ul li:last-child a,#header-post ul li:last-child{margin-right:0}.width{width:100%;max-width:39rem}@media (max-width:480px){.my4{margin-top:2rem;margin-bottom:2rem}}#header-post #nav ul{line-height:15px}#header-post #nav{font-style:normal;font-weight:200;letter-spacing:.01em;font-size:.8rem;color:#2bbc8a}#header-post{position:fixed;top:2rem;right:2rem;display:inline-block;float:right}#header-post ol{list-style-type:none}#header-post ul{list-style-type:none;margin:0;padding:0;display:inline-block}#header-post ul li{margin-right:15px;display:inline-block;vertical-align:middle}#header-post #menu-icon,#header-post #menu-icon-tablet{float:right;margin-left:15px}#header-post #top-icon-tablet{margin-left:15px;bottom:2rem;right:2rem;position:fixed}#header-post #menu{visibility:hidden}#header-post #nav ul a{margin-right:15px;color:color-accent}#header-post #nav ul li:last-child{border-right:0;margin-right:0}#header-post #toc{clear:both;text-align:right;padding-top:1rem}#header-post #toc .toc-number{display:none}#header-post #toc .toc-level-2{font-size:.8rem;color:#c9cacc}#header-post #toc .toc-level-2:before{color:#2bbc8a}@media screen and (max-width:500px){#header-post{display:none}}@media screen and (max-width:900px){#header-post #menu-icon{display:none}}@media screen and (max-width:1199px){#header-post #toc{display:none}}@media screen and (min-width:900px){#header-post #menu-icon-tablet,#header-post #top-icon-tablet{display:none!important}}#footer-post{bottom:0;left:0;right:0;position:fixed;width:100%;z-index:5000000;background:#212326;border-top:1px solid #666673}#footer-post a,#footer-post a.icon{background:0 0}#footer-post a{color:inherit;text-decoration:none}#footer-post #nav-footer{margin-left:1rem;margin-right:1rem;text-align:center}#footer-post #nav-footer a{color:#2bbc8a;font-size:1rem}#footer-post #actions-footer ul,#footer-post #nav-footer ul{list-style-type:none;margin:0;padding:0;display:table;width:100%}#footer-post #nav-footer ul li{display:inline-table;width:20%;padding:10px;vertical-align:middle}#footer-post #actions-footer{text-align:center;margin-top:1rem;margin-bottom:1rem;width:100%}#footer-post #actions-footer a{color:#2bbc8a}#footer-post #actions-footer ul li{display:table-cell;vertical-align:middle}#footer-post #toc-footer .toc-number{display:none}#footer-post #toc-footer{clear:both;text-align:left;padding-top:1rem}#footer-post #toc-footer ol{list-style-type:none;padding-left:20px}#footer-post #toc-footer ol li{line-height:30px}#footer-post #toc-footer .toc-level-2{font-size:.8rem;color:#c9cacc}#footer-post #toc-footer .toc-level-2:before{content:"#";color:#2bbc8a}@media screen and (min-width:500px){#footer-post-container{display:none}}article header .posttitle{margin-top:0;margin-bottom:0;text-transform:none;font-size:1.5em;line-height:1.25}article header .meta{margin-top:0;margin-bottom:1rem}article header .meta *{color:#ccc;font-size:.85rem}article header .author{text-transform:uppercase;letter-spacing:.01em;font-weight:700}article header .postdate{display:inline}article .content h2:before{color:#2bbc8a;position:absolute;left:-1rem;top:-4px;font-size:1.2rem;font-weight:700}article .content img{max-width:100%;height:auto;display:block;margin:auto}.posttitle{text-transform:none;font-size:1.5em;line-height:1.25}@media (min-width:480px){p{text-align:justify}.article-tag{display:inline}.article-tag:before{content:"|"}}.highlight,pre{overflow-x:auto}pre{font-size:13px;padding:10px 15px 0;line-height:22px;-webkit-border-radius:4px;border-radius:4px;border:1px dotted #666}.highlight{color:#d1d9e1;background:#212326;-webkit-border-radius:4px;border-radius:4px;padding:10px 15px;margin:1rem 0}.highlight pre{padding:0;border:none;background:0 0}.highlight table{width:auto}.highlight td.gutter{text-align:right;padding-right:20px;display:none}</style></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></span><br><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy-en-ES6"><span class="toc-number">1.</span> <span class="toc-text">Proxy en ES6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Usando-Proxy-ES6-para-prevenir-acceso-a-propiedades-inexistentes"><span class="toc-number">2.</span> <span class="toc-text">Usando Proxy ES6 para prevenir acceso a propiedades inexistentes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Soporte-y-uso-con-Babel"><span class="toc-number">3.</span> <span class="toc-text">Soporte y uso con Babel</span></a></li></ol></div></span></div><div class="content index width mx-auto px2 my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Jugando con el objeto Proxy de ECMAScript6</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Emilio J. Grande | Web Developer</span></span><div class="postdate"><time datetime="2016-02-08T06:00:00.000Z" itemprop="datePublished">08-02-2016</time></div><div class="article-tag"><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/es2015/">es2015</a>, <a class="tag-link" href="/tags/es6/">es6</a></div></div></header><div class="content" itemprop="articleBody"><p><img src="/images/2016-02/proxy.jpg" alt="Proxy"></p><p>JavaScript avanza tan deprisa que es complicado estar al día de todas las cosas nuevas que salen. Uno de las novedades más interesantes que llegará próximamente es el objeto Proxy.</p><h2 id="Proxy-en-ES6"><a href="#Proxy-en-ES6" class="headerlink" title="Proxy en ES6"></a>Proxy en ES6</h2><p>MDN define el <a href="https://developer.mozilla.org/es/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="external">Proxy</a> como un <strong>objeto que puede utilizarse para añadir comportamiento personalizado a operaciones básicas de otro</strong>.</p><p>Un ejemplo: <em>tengo un objeto P. Cuando la propiedad P.foo cambie, <strong>además haz tal cosa</strong></em>. A eso nos ayuda el Proxy.</p><p>Veámoslo:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&apos;use strict&apos;</div><div class="line"></div><div class="line">let target = &#123;&#125;</div><div class="line">let handler = &#123;</div><div class="line">  get: (target, prop) =&gt; &#123;</div><div class="line">    console.log(`Someone wants to know *$&#123;prop&#125;*!`)</div><div class="line">    return target[prop]</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">let p = new Proxy(target, handler)</div><div class="line">p.name = &apos;Bart&apos;</div><div class="line">console.log(p.name)</div></pre></td></tr></table></figure><p><img src="/images/2016-02/proxy_example.PNG" alt="Ejemplo Proxy"></p><p>Básicamente, al constructor de Proxy se le pasan 2 cosas:</p><ul><li>Un objeto sobre el que actuar de proxy.</li><li>Otro objeto con <em>hooks</em> sobre las operaciones JavaScript que quieras interceptar sobre el objeto original. Aquí puedes <em>hookear</em> operaciones como Get, Set, Apply…</li></ul><h2 id="Usando-Proxy-ES6-para-prevenir-acceso-a-propiedades-inexistentes"><a href="#Usando-Proxy-ES6-para-prevenir-acceso-a-propiedades-inexistentes" class="headerlink" title="Usando Proxy ES6 para prevenir acceso a propiedades inexistentes"></a>Usando <strong>Proxy ES6</strong> para prevenir acceso a propiedades inexistentes</h2><p>Vamos a utilizar el Proxy ES6 para crear objetos que <em>tiren</em> excepciones cuando se intente acceder a propiedades que no tengan definidas, para evitar el famoso <em>undefined</em> que no da error y a veces es difícil de depurar.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&apos;use strict&apos;</div><div class="line"></div><div class="line">let dummyObj = &#123;</div><div class="line">  name: &apos;Bart&apos;</div><div class="line">&#125;</div><div class="line"></div><div class="line">let awareObject = new Proxy(dummyObj, &#123;</div><div class="line">  get: (target, property) =&gt; &#123;</div><div class="line">    if (property in target) &#123;</div><div class="line">      return target[property]</div><div class="line">    &#125; else &#123;</div><div class="line">      throw new Error(`Hey! $&#123;property&#125; does not exist in $&#123;target&#125;`)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">console.log(dummyObj.name)</div><div class="line">console.log(dummyObj.surname)</div><div class="line"></div><div class="line">console.log(awareObject.name)</div><div class="line">console.log(awareObject.surname)</div></pre></td></tr></table></figure><p>Esto simplemente utiliza el Proxy para ver si el objeto al que se intenta acceder. La salida, como podéis suponer, es la siguiente:</p><p><img src="/images/2016-02/aware_object.png" alt="Objeto con chequeo de propiedades"></p><h2 id="Soporte-y-uso-con-Babel"><a href="#Soporte-y-uso-con-Babel" class="headerlink" title="Soporte y uso con Babel"></a>Soporte y uso con Babel</h2><p>Actualmente <a href="http://kangax.github.io/compat-table/es6/#Proxy" target="_blank" rel="external">no hay demasiado soporte</a> para utilizar el Proxy. Yo lo he probado con <a href="https://www.google.es/chrome/browser/canary.html" target="_blank" rel="external">Chrome Canary</a> y con <a href="https://babeljs.io/" target="_blank" rel="external">Babel</a>.</p><p>Si quieres probarlo con Babel tendrías que instalar <a href="https://github.com/krzkaczor/babel-plugin-proxy/">este plugin</a>:</p><p><strong>NOTA</strong>: es experimental y no deberías usarlo en producción por el impacto que podría tener en el rendimiento.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev babel-plugin-proxy</div></pre></td></tr></table></figure><p>E indicar el uso de este plugin en el fichero de configuración de Babel:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"presets"</span>: [<span class="string">"es2015"</span>] ,</div><div class="line">  <span class="string">"plugins"</span>: [<span class="string">"babel-plugin-proxy"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure><hr><p>Por otra parte si quieres trastear un poco con ello, te <strong>recomiendo encarecidamente <a href="http://codepen.io/" target="_blank" rel="external">Codepen</a></strong>. De hecho te lo recomiendo para trastear con casi cualquier cosa. Se pueden añadir todo tipo de preprocesadores sin ningún tipo de instalación y puedes probar casi todo con él.</p><p>¡Buena semana!</p></div></article></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy-en-ES6"><span class="toc-number">1.</span> <span class="toc-text">Proxy en ES6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Usando-Proxy-ES6-para-prevenir-acceso-a-propiedades-inexistentes"><span class="toc-number">2.</span> <span class="toc-text">Usando Proxy ES6 para prevenir acceso a propiedades inexistentes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Soporte-y-uso-con-Babel"><span class="toc-number">3.</span> <span class="toc-text">Soporte y uso con Babel</span></a></li></ol></div><div id="actions-footer"><ul><li id="toc"><a class="icon" href="#actions-footer"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li><li id="top" style="display:none"><a class="icon" href="#"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li><li id="menu"><a class="icon" href="#actions-footer"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li></ul></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2017 Emilio J. Grande</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archives">Writing</a></li><li><a href="/projects">Projects</a></li><li><a href="/about">About</a></li><li><a href="/contact">Contact</a></li></ul></nav></div></footer><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/meslo-LG/styles.css"><link rel="stylesheet" href="/css/style.css"><script src="/js/main.js"></script></body></html>